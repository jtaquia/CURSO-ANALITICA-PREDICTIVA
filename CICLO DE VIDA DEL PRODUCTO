'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'INICIALIZA EL FORMULARIO PARA REALIZAR EL FILTRADO

'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


Private Sub UserForm_Initialize()
Dim IRange As Range
Dim ORange As Range



'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Worksheets("Hoja1").Activate

Worksheets("Hoja1").Range(Cells(1, 14), Cells(300, 300)).ClearContents




'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

FinalRow = Cells(Rows.Count, 1).End(xlUp).Row
NextCol = Cells(1, Columns.Count).End(xlToLeft).Column + 2

Set IRange = Range("A1").Resize(FinalRow, NextCol - 2)
IRange.Select


Cells(1, 5).Copy Destination:=Cells(1, NextCol)  'COLOR

Set ORange = Cells(1, NextCol)

IRange.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ORange, Unique:=True

LastRow = Cells(Rows.Count, NextCol).End(xlUp).Row

Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
Order1:=xlAscending, Header:=xlYes


With Me.lbSubcat
.RowSource = ""
.List = Cells(2, NextCol).Resize(LastRow - 1, 1).Value
End With

Cells(1, NextCol).Resize(LastRow, 1).Clear


'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

FinalRow = Cells(Rows.Count, 1).End(xlUp).Row
NextCol = Cells(1, Columns.Count).End(xlToLeft).Column + 2

Cells(1, 6).Copy Destination:=Cells(1, NextCol) 'HORMA

Set ORange = Cells(1, NextCol)
Set IRange = Range("A1").Resize(FinalRow, NextCol - 2)

IRange.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ORange, Unique:=True

LastRow = Cells(Rows.Count, NextCol).End(xlUp).Row

'Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
'Order1:=xlAscending, Key2:=Cells(1, NextCol + 1), Order2:=xlAscending, Header:=xlYes

Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
Order1:=xlAscending, Header:=xlYes



With Me.LMarca 'HORMA
.RowSource = ""
.List = Cells(2, NextCol).Resize(LastRow - 1, 1).Value
End With

Cells(1, NextCol).Resize(LastRow, 1).Clear


'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

FinalRow = Cells(Rows.Count, 1).End(xlUp).Row
NextCol = Cells(1, Columns.Count).End(xlToLeft).Column + 2

Cells(1, 7).Copy Destination:=Cells(1, NextCol)  'TOBILLO

Set ORange = Cells(1, NextCol)

IRange.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ORange, Unique:=True

LastRow = Cells(Rows.Count, NextCol).End(xlUp).Row

'Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
'Order1:=xlAscending, Key2:=Cells(1, NextCol + 1), Order2:=xlAscending, Header:=xlYes

Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
Order1:=xlAscending, Header:=xlYes

With Me.LForma
.RowSource = ""
.List = Cells(2, NextCol).Resize(LastRow - 1, 1).Value
End With

Cells(1, NextCol).Resize(LastRow, 1).Clear


'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

FinalRow = Cells(Rows.Count, 1).End(xlUp).Row
NextCol = Cells(1, Columns.Count).End(xlToLeft).Column + 2

Cells(1, 10).Copy Destination:=Cells(1, NextCol) 'PLANTA

Set ORange = Cells(1, NextCol)

IRange.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ORange, Unique:=True

LastRow = Cells(Rows.Count, NextCol).End(xlUp).Row

'Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
'Order1:=xlAscending, Key2:=Cells(1, NextCol + 1), Order2:=xlAscending, Header:=xlYes

Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
Order1:=xlAscending, Header:=xlYes

With Me.LColor ' PLANTA
.RowSource = ""
.List = Cells(2, NextCol).Resize(LastRow - 1, 1).Value
End With

Cells(1, NextCol).Resize(LastRow, 1).Clear


'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


FinalRow = Cells(Rows.Count, 1).End(xlUp).Row
NextCol = Cells(1, Columns.Count).End(xlToLeft).Column + 2

Set IRange = Range("A1").Resize(FinalRow, NextCol - 2)

Cells(1, 12).Copy Destination:=Cells(1, NextCol) ' TACO

Set ORange = Cells(1, NextCol)

IRange.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ORange, Unique:=True

LastRow = Cells(Rows.Count, NextCol).End(xlUp).Row

Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
Order1:=xlAscending, Header:=xlYes


With Me.LLinea 'TACO
.RowSource = ""
.List = Cells(2, NextCol).Resize(LastRow - 1, 1).Value
End With

Cells(1, NextCol).Resize(LastRow, 1).Clear


'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


FinalRow = Cells(Rows.Count, 1).End(xlUp).Row
NextCol = Cells(1, Columns.Count).End(xlToLeft).Column + 2

Set IRange = Range("A1").Resize(FinalRow, NextCol - 2)

Cells(1, 11).Copy Destination:=Cells(1, NextCol) '

Set ORange = Cells(1, NextCol)

IRange.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ORange, Unique:=True

LastRow = Cells(Rows.Count, NextCol).End(xlUp).Row

Cells(1, NextCol).Resize(LastRow, 1).Sort Key1:=Cells(1, NextCol), _
Order1:=xlAscending, Header:=xlYes


With Me.LPiedra ' NUMERO TACO
.RowSource = ""
.List = Cells(2, NextCol).Resize(LastRow - 1, 1).Value
End With

Cells(1, NextCol).Resize(LastRow, 1).Clear

'Worksheets("Hoja3").Activate
'Worksheets("Hoja3").Select


End Sub
Function BuscarHoja1(nombreHoja As String) As Boolean
 
    For i = 1 To Worksheets.Count
        If Worksheets(i).Name = nombreHoja Then
            BuscarHoja1 = True
            Exit Function
        End If
    Next
     
    BuscarHoja1 = False
 
End Function


